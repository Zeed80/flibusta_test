# –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã OPDS

## üîç –®–∞–≥ 1: –ù–∞–π–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ PHP-FPM

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–µ—Ä–µ–∑ SSH):

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ù–∞–π—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä PHP-FPM
docker ps | grep php-fpm

# –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ–∏—Å–∫–∞
chmod +x /flibusta_test/scripts/find_php_fpm_container.sh
/flibusta_test/scripts/find_php_fpm_container.sh
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
CONTAINER ID   IMAGE                    STATUS
abc123def456   flibusta_test-php-fpm    Up 2 hours ago
```

–ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±—É–¥–µ—Ç —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:
- `flibusta_test-php-fpm-1`
- `flibusta_php-fpm_1`
- `php-fpm-1`
- –∏–ª–∏ –¥—Ä—É–≥–æ–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üöÄ –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã

–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã –Ω–∞—à–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ CONTAINER_NAME –Ω–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–µ –∏–º—è
docker exec -it CONTAINER_NAME php /application/tests/test_opds.php
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```bash
# –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è flibusta_test-php-fpm-1 (–≤–∞—à —Å–ª—É—á–∞–π)
docker exec -it flibusta_test-php-fpm-1 php /application/tests/test_opds.php

# –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è flibusta_php-fpm_1
docker exec -it flibusta_php-fpm_1 php /application/tests/test_opds.php

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ (–µ—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å php-fpm)
docker exec -it $(docker ps | grep php-fpm | awk '{print $1}') php /application/tests/test_opds.php
```

**–ò–ª–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä:**
```
http://–≤–∞—à-ip:27100/tests/test_opds.php
```

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: —á–µ—Ä–µ–∑ docker-compose

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ `docker-compose.yml`:

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /flibusta_test

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ docker-compose
docker-compose exec php-fpm php /application/tests/test_opds.php
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë     OPDS –¢–ï–°–¢–û–í–ê–ù–ò–ï –°–ò–°–¢–ï–ú–´          ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
–ë–∞–∑–æ–≤—ã–π URL: http://localhost:27100/opds/
–ó–∞–ø—É—Å–∫: 2024-12-26 18:00:00

========================================
–¢–ï–°–¢: –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ OPDS (/)
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ PASSED
–°–æ–æ–±—â–µ–Ω–∏–µ: –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
...

========================================
–°–í–û–î–ù–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–ï–°–¢–û–í
–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 25
–ü—Ä–æ–π–¥–µ–Ω–æ: 23 (92%)
–ü—Ä–æ–≤–∞–ª–µ–Ω–æ: 2 (8%)
–£—Å–ø–µ—à–Ω–æ—Å—Ç—å: 92%
```

## ‚ùå –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "No such container"
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–∑ –®–∞–≥–∞ 1 –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "Container is not running"
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Permission denied"
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–∞–π–ª —Ç–µ—Å—Ç–∞
docker exec -it CONTAINER_NAME ls -la /application/tests/test_opds.php

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞
docker exec -it CONTAINER_NAME chmod +x /application/tests/test_opds.php
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "File not found"
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
docker exec -it CONTAINER_NAME ls -la /application/tests/

# –ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```

## üéØ –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ (–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ)

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∏ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
CONTAINER=$(docker ps | grep php-fpm | awk '{print $NF}' | head -1)
if [ -n "$CONTAINER" ]; then
    echo "–ù–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: $CONTAINER"
    docker exec -it "$CONTAINER" php /application/tests/test_opds.php
else
    echo "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä PHP-FPM –Ω–µ –Ω–∞–π–¥–µ–Ω!"
    echo "–ó–∞–ø—É—Å—Ç–∏—Ç–µ: docker ps | grep php-fpm"
fi
```

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –¢–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±—ã–ª–∏ –∑–∞–ø—É—â–µ–Ω—ã (`docker-compose up -d`)
- –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å OPDS —á–µ—Ä–µ–∑ HTTP, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—é—â–∏–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- –ï—Å–ª–∏ —Ç–µ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs php-fpm --tail=50`
