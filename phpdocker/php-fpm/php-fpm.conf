; PHP-FPM конфигурация для продакшен
php_flag[display_errors] = off
php_admin_flag[log_errors] = on

[www]
; Процессы должны динамически меняться в зависимости от нагрузки
pm = dynamic
pm.max_children = 50
pm.start_servers = 5
pm.min_spare_servers = 5
pm.max_spare_servers = 10
pm.max_requests = 500

; Таймауты для предотвращения зависания процессов
; Увеличено для длительных операций (импорт SQL, индексация ZIP)
request_terminate_timeout = 7200
request_slowlog_timeout = 300

; Логирование медленных запросов
slowlog = /var/log/php-fpm-slow.log
request_slowlog_timeout = 5s

; Логирование
access.log = /var/log/php-fpm-access.log
access.format = "%R - %u %t \"%m %r%Q%q\" %s %f %{mili}d %{kilo}M %C%%"
